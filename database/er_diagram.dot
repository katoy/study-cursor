digraph TicTacToeDB {
    rankdir=LR;
    node [shape=box, fontname="Helvetica"];
    edge [fontname="Helvetica"];

    algorithms [label="algorithms\n---\nid: INTEGER PK\nname: TEXT NOT NULL UK"];
    game_results [label="game_results\n---\nid: INTEGER PK\nplayed_at: TIMESTAMP NOT NULL\nalgorithm_id: INTEGER NOT NULL FK\nhuman_is_first: BOOLEAN NOT NULL\nwinner: CHAR(1) NOT NULL"];
    moves [label="moves\n---\ngame_id: INTEGER PK FK\nmove_number: INTEGER PK\nposition: INTEGER NOT NULL\nmark: CHAR(1) NOT NULL"];
    perfect_moves [label="perfect_moves\n---\nstate: CHAR(9) PK\nnext_player: CHAR(1) PK\nbest_move: INTEGER\nscore: INTEGER NOT NULL"];

    algorithms -> game_results [label="1:N"];
    game_results -> moves [label="1:N"];

    {rank=same; algorithms game_results}
    {rank=same; moves perfect_moves}

    // Notes
    node [shape=note, style=filled, fillcolor=lightyellow];
    algorithms_note [label="アルゴリズム名:\n- ランダム\n- ミニマックス\n- 完全戦略"];
    game_results_note [label="winner:\n- H: 人間\n- C: コンピュータ\n- D: 引き分け"];
    moves_note [label="position: 0-8\nmark: X または O"];
    perfect_moves_note [label="state: -XO の9文字\nscore: 1=X勝ち,\n0=引分, -1=O勝ち"];

    algorithms -> algorithms_note [style=dotted];
    game_results -> game_results_note [style=dotted];
    moves -> moves_note [style=dotted];
    perfect_moves -> perfect_moves_note [style=dotted];
} 